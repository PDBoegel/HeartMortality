```{r, echo = FALSE}
#Functions used throughout document
makeHistograms <- function(df) {
  
  
}

```

Gathering Data:
```{r}
heartmortCOMPLETE = read.csv(file = "https://raw.githubusercontent.com/PDBoegel/HeartMortality/master/HeartMort.csv", header = TRUE)
heartmort = heartmortCOMPLETE[-c(1:4,7,24:26)] #Getting rid of variables for metadata and other dependent variable
```

# Naive linear model for insights

```{r}
heartmort$PCTPOPUNDER65 = heartmortCOMPLETE$PCTPOP30TO65 + heartmortCOMPLETE$PCTPOPUNDER30
naivelm = lm(HDMORTPERPERSON ~ ., data = heartmort)
summary(naivelm)
```


```{r}
hist(heartmort$POPSIZE)
hist(heartmort$HDMORTPERPERSON)
hist(heartmort$POPDENSITY)
hist(heartmort$HOUSINGUNITS)
hist(heartmort$HOUSINGUNITDENSITY)
hist(heartmort$AVGINCOMEPERPERSON)
hist(heartmort$PCTDIABETES)
hist(heartmort$PCTMALE)
hist(heartmort$PCTFEMALE)
hist(heartmort$PCTWHITE)
hist(heartmort$PCTAFRAM)
hist(heartmort$PCTASIANAM)
hist(heartmort$PCTNATIVEAM)
hist(heartmort$LOWEDUCATION)
hist(heartmort$MEDEDUCATION)
hist(heartmort$HIGHEDUCATION)
hist(heartmort$TOTUNEMPLOYED)
hist(heartmort$PCTUNEMPLOYED)
hist(heartmort$PCTOBESE)
hist(heartmort$PCTPOPUNDER65)
```


```{r}

hist(log(heartmort$POPSIZE))
hist(log(heartmort$HDMORTPERPERSON))
hist(log(heartmort$POPDENSITY))
hist(log(heartmort$HOUSINGUNITS))
hist(log(heartmort$HOUSINGUNITDENSITY))
hist(log(heartmort$AVGINCOMEPERPERSON))
hist(log(heartmort$PCTDIABETES))
hist(log(heartmort$PCTMALE))
hist(log(heartmort$PCTFEMALE))
hist(log(heartmort$PCTWHITE))
hist(log(heartmort$PCTAFRAM))
hist(log(heartmort$PCTASIANAM))
hist(log(heartmort$PCTNATIVEAM))
hist(log(heartmort$LOWEDUCATION))
hist(log(heartmort$MEDEDUCATION))
hist(log(heartmort$HIGHEDUCATION))
hist(log(heartmort$TOTUNEMPLOYED))
hist(log(heartmort$PCTUNEMPLOYED))
hist(log(heartmort$PCTOBESE))
hist(log(heartmort$PCTPOPUNDER65))
```
Variables that need to be transformed:

POPSIZE [log]
HDMORTPERPERSON [log]
TOTHDMORT [log]
POPDENSITY [log]
HOUSINGUNITS [log]
HOUSINGUNITDENSITY [log]
AVGINCOMEPERPERSON [log]

TOTUNEMPLOYED [log]
PCTUNEMPLOYED [log]

```{r}
theartmort <- heartmort
theartmort$POPSIZE <- log(heartmort$POPSIZE)
theartmort$HDMORTPERPERSON <- log(heartmort$HDMORTPERPERSON + 1)
theartmort$POPDENSITY <- log(heartmort$POPDENSITY + 1)
theartmort$HOUSINGUNITS <- log(heartmort$HOUSINGUNITS + 1)
theartmort$HOUSINGUNITDENSITY <- log(heartmort$HOUSINGUNITDENSITY + 1)
theartmort$AVGINCOMEPERPERSON <- log(heartmort$AVGINCOMEPERPERSON + 1)
theartmort$TOTUNEMPLOYED <- log(heartmort$TOTUNEMPLOYED + 1)
```

```{r}
tlm = lm(HDMORTPERPERSON ~ ., data = theartmort)
summary(tlm)
```

```{r}
newmodel <- lm(HDMORTPERPERSON ~ HOUSINGUNITS + PCTDIABETES + PCTWHITE + PCTAFRAM + PCTASIANAM + PCTNATIVEAM + PCTOBESE + PCTPOPUNDER65, data = theartmort)
summary(newmodel)
```

```{r}
for(i in 1:dim(theartmort)[1]){
  theartmort$MALEDOM[i] <- 0
  if(theartmort$PCTMALE[i] >= 50){
    theartmort$MALEDOM[i] <- 1
  }
  
}
```

```{r}
newmodel <- lm(HDMORTPERPERSON ~ HOUSINGUNITS + PCTDIABETES + PCTWHITE + PCTAFRAM + PCTASIANAM + PCTNATIVEAM + PCTOBESE + PCTPOPUNDER65 + factor(MALEDOM), data = theartmort)
summary(newmodel)
```


```{r}

summary(heartmort)







```

```{r}
resid = rstandard(tlm)
leverage = hatvalues(tlm) 

hist(resid, main="Histogram of Standardized Residuals", xlab = "Standardized Residual")


k = dim(heartmort)[2]
n = dim(heartmort)[1]
averagelev = (k+1)/n
3*averagelev
hist(leverage, main="Histogram of Leverages", xlab = "Leverage", breaks = 15)
```
```{r}
which(leverage > 3*averagelev)
length(which(leverage > 3*averagelev))

which(leverage > 6*averagelev)
length(which(leverage > 6*averagelev))

```

```{r}
which(leverage > 6*averagelev)

lev6heartmort = theartmort[-c(which(leverage > 6*averagelev))]
lmlev6 = lm(HDMORTPERPERSON ~ ., data = lev6heartmort)
summary(lmlev6)
```

```{r}
residlev6 = rstandard(lmlev6)
leveragelev6 = hatvalues(lmlev6) 

hist(residlev6, main="Histogram of Standardized Residuals", xlab = "Standardized Residual")


k = dim(heartmortlev6)[2]
n = dim(heartmortlev6)[1]
averagelev = (k+1)/n
3*averagelev
hist(leveragelev6, main="Histogram of Leverages", xlab = "Leverage", breaks = 15)





```




